var Arbiter=function(){var n=function(){var r={},e={},t={},i={},s=1;return{version:"1.0",updated_on:"2011-12-19",create:function(){return n()},subscribe:function(){var n,u,c,f,o,l,a,p,b={},h=!1,g=0,v=[];if(arguments.length<2)return null;u=arguments[0],l=arguments[arguments.length-1],arguments.length>2&&(b=arguments[1]||{}),arguments.length>3&&(a=arguments[2]),b.priority&&(g=b.priority),"string"==typeof u&&(u=u.split(/[,\s]+/));for(var d=0;d<u.length;d++)if(n=u[d],/\*$/.test(n)?(h=!0,n=n.replace(/\*$/,""),c=e[n],c||(e[n]=c=[])):(c=r[n],c||(r[n]=c=[])),p=s++,o={id:p,f:l,p:g,self:a,options:b},i[p]=o,c.push(o),c=c.sort(function(n,r){return n.p>r.p?-1:n.p==r.p?0:1}),h?e[n]=c:r[n]=c,v.push(p),!b.persist&&t[n]){f=t[n];for(var y=0;y<f.length;y++)o.f.call(o.self,f[y],{persist:!0})}return u.length>0?v:v[0]},publish:function(n,i,s){var u,c,f,o=10,l=!0,a=!0,p={},b=r[n]||[];s=s||{};for(f in e)0==n.indexOf(f)&&(b=b.concat(e[f]));if(s.persist===!0&&(t[n]||(t[n]=[]),t[n].push(i)),0==b.length)return l;"boolean"==typeof s.cancelable&&(a=s.cancelable);for(var h=0;h<b.length;h++)if(c=b[h],!c.unsubscribed)try{if(s.async===!0||c.options&&c.options.async)setTimeout(function(r){return function(){r.f.call(r.self,i,n,p)}}(c),o++);else if(u=c.f.call(c.self,i,n,p),a&&u===!1)break}catch(g){l=!1}return l},unsubscribe:function(n){return!!i[n]&&(i[n].unsubscribed=!0,!0)},resubscribe:function(n){return!!i[n]&&(i[n].unsubscribed=!1,!0)}}};return n()}();
